# 分组名称功能说明

## 功能概述

为 LogicFlow 拓扑图添加了分组名称功能，支持为节点分组添加可编辑的名称标签。

## 新增功能

### 1. 创建分组按钮

在控制面板中新增了"创建分组"按钮（📦图标），位于"一键美化"和"居中"按钮下方。

**使用方法：**
1. 使用 Shift + 鼠标点击 选择多个节点（至少2个）
2. 点击右上角的"分组"按钮（📦图标）
3. 系统会自动创建一个包含所选节点的分组，并添加默认名称"新建分组"

### 2. 分组名称编辑

**双击编辑：**
- 双击分组名称文本即可进入编辑模式
- 输入新的分组名称后按回车或点击其他区域完成编辑

**样式特点：**
- 分组名称显示为蓝色（#1890ff）
- 字体粗细：600
- 编辑时会显示蓝色边框和输入框
- 聚焦时有蓝色阴影效果

### 3. 自动分组

当通过 NodeSelection 插件或其他方式创建 group 类型节点时，系统会自动为其添加默认名称"新建分组"。

## 技术实现

### 核心代码修改

1. **导入 Group 插件**
   ```javascript
   import { Group } from '@logicflow/extension'
   ```

2. **启用文本编辑**
   ```javascript
   lf = new LogicFlow({
     // ...其他配置
     textEdit: true,
     textDblClickEdit: true
   })
   ```

3. **监听节点创建事件**
   - 监听 `node:add` 事件
   - 检测 group 类型节点
   - 自动添加默认名称和编辑属性

4. **创建分组函数**
   ```javascript
   const handleCreateGroup = (lfInstance) => {
     // 获取选中节点
     // 计算分组边界
     // 创建带名称的分组节点
   }
   ```

### 样式定制

在 `<style>` 部分添加了分组文本的专属样式：

```less
:deep(.lf-node-group) {
  .lf-node-text {
    font-size: 14px;
    font-weight: 600;
    fill: #1890ff;
    cursor: text;
    user-select: none;
  }

  .lf-node-text-edit {
    font-size: 14px;
    font-weight: 600;
    color: #1890ff;
    padding: 4px 8px;
    border: 1px solid #1890ff;
    border-radius: 4px;
    background: white;
    outline: none;

    &:focus {
      border-color: #40a9ff;
      box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.2);
    }
  }
}
```

## 使用示例

### 创建分组的完整流程

1. **选择节点**
   - 按住 Shift 键
   - 依次点击要分组的节点
   - 确保至少选择了2个非分组节点

2. **创建分组**
   - 点击右上角控制面板的"分组"按钮（📦）
   - 系统自动创建分组并显示"新建分组"文本

3. **修改分组名称**
   - 双击"新建分组"文本
   - 输入新名称，例如"核心服务器"
   - 按回车或点击其他区域完成编辑

4. **保存拓扑**
   - 点击右下角的"保存"按钮
   - 分组及其名称会被持久化保存

## 注意事项

1. **最小节点数**：创建分组至少需要选择2个节点

2. **节点类型限制**：不能将分组节点添加到另一个分组中（避免嵌套分组）

3. **文本位置**：分组名称默认显示在分组顶部上方20px处

4. **分组边距**：分组边界会在选中节点周围留出30px的内边距

5. **自动计算**：分组的大小和位置会根据包含的节点自动计算

## 快捷键

- **Shift + 点击**：多选节点
- **Delete/Backspace**：删除选中的分组或节点
- **双击文本**：编辑分组名称
- **Ctrl + Shift + K**：打开/关闭调试面板

## 浏览器支持

该功能在所有现代浏览器中均可正常使用：
- Chrome/Edge (推荐)
- Firefox
- Safari

## 更新日志

**Version 1.0**
- ✅ 添加创建分组按钮
- ✅ 支持分组名称双击编辑
- ✅ 自动为新分组添加默认名称
- ✅ 美化分组文本样式
- ✅ 添加分组创建快捷操作

## 未来改进

- [ ] 支持分组颜色自定义
- [ ] 支持分组折叠/展开
- [ ] 支持分组拖拽调整大小
- [ ] 支持分组模板预设
- [ ] 支持分组右键菜单
